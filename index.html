<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="assets/CSS/Style.css" rel="stylesheet">
    <link href="assets/CSS/Bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <title>Index</title>
</head>
<body>

  <div class="container mt-5 align-content-center">
    <h1 class="text-center">Bienvenue</h1>

    <button class="btn btn-success" onclick="logout()">deconnecter</button>
  </div>

  <!-- //afficher les utilisateurs -->
  <div class="container mt-4">
    <h2 class="text-center">Liste des utilisateurs</h2>
    <table class="table table-striped table-bordered" id="usersTable">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Nom</th>
                <th>Email</th>
            </tr>
        </thead>
        <tbody>
            <!-- Les données seront insérées ici -->
        </tbody>
    </table>
</div>

  </body>
  <script>
    // recuperer le nom d'utilisateur
    const username = localStorage.getItem('username');
    document.addEventListener('DOMContentLoaded', function() {
      const token = localStorage.getItem('authToken');
      if (!token) {
        window.location.href = 'auth.html';
      }
    });
  function logout() {
  // Supprime le token stocké
  localStorage.removeItem('authToken');
  window.location.reload();
}

    </script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    $(document).ready(function () {
        fetch('http://localhost:3000/users')
            .then(response => response.json())
            .then(users => {
                let rows = '';
                users.forEach(user => {
                    rows += `<tr>
                                <td>${user.id}</td>
                                <td>${user.name || 'N/A'}</td>
                                <td>${user.email}</td>
                             </tr>`;
                });
                $('#usersTable tbody').html(rows);
                $('#usersTable').DataTable(); // Activation de DataTables
            })
            .catch(error => console.error('Erreur de chargement:', error));
    });
</script>


</html>